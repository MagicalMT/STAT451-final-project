---
title: "Project"
author: "TaoZhang, Gefei Shen, Xuhao Wang, simon xiong"
date: "2024-11-10"
output: html_document
---

```{r}
library(dplyr)
library(ggplot2)
library(reshape2)
library(corrplot)

```



```{r}
data <- read.csv("C:/Users/86130/Desktop/STAT451/Final_project/user_behavior_dataset.csv")

```










### Question 1: What are the number of device models across different age groups?





```{r}
data$Age_Group <- cut(data$Age, breaks = c(18, 28, 38, 48, 60, Inf), labels = c("18-28", "29-38", "39-48", "49-60", "60+"), right = FALSE)

device_counts <- data %>%
  group_by(Age_Group) %>%
  summarise(Device_Model_Count = n_distinct(Device.Model))

ggplot(device_counts, aes(x = "", y = Device_Model_Count, fill = Age_Group)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y") +
  labs(title = "Number of Device Models Across Different Age Groups") +
  theme_void() +
  theme(legend.position = "right")

# Count unique device models per individual age
device_counts <- data %>%
  filter(Age >= 18, Age <= 60) %>%
  group_by(Age) %>%
  summarize(UniqueDeviceModels = n_distinct(Device.Model))

# Create the line plot
ggplot(device_counts, aes(x = Age, y = UniqueDeviceModels)) +
  geom_line() +
  geom_point() +
  labs(title = "Unique Device Models by Age",
       x = "Age",
       y = "Number of Unique Device Models") +
  theme_minimal()
```
The data grouped users by age categories (0-18, 19-30, 31-45, 46-60) and counted the distinct device models per age group. The information is visualized as a pie chart representing each age group and the number of device models they use.This appears to be a very uniform data set, and after that, our group looked at the sources of this data set and it seemed to be evenly distributed according to the age interval

Then we looked at the discounted statistical graph, and the distribution of this age was also very uniform, with a maximum error of two and a minimum error of one for each age group. It stays between 4+-1




### Question 2: How does screen time vary by different age groups?

```{r}
screen_time <- data %>%
  group_by(Age_Group, Gender) %>%
  summarise(Average_Screen_Time = mean(Screen.On.Time..hours.day., na.rm = TRUE), .groups = "drop")


ggplot(screen_time, aes(x = Age_Group, y = Average_Screen_Time, color = Gender, group = Gender)) +
  geom_line() +
  geom_point() +
  labs(title = "Screen Time by Age Group and Gender",
       x = "Age Group",
       y = "Average Screen On Time (hours/day)") +
  theme_minimal()


screen_time_individual <- data %>%
  group_by(Age) %>%
  summarise(Average_Screen_On_Time = mean(Screen.On.Time..hours.day., na.rm = TRUE))

# Plot the average screen time by age
ggplot(screen_time_individual, aes(x = Age, y = Average_Screen_On_Time)) +
  geom_line() +
  geom_point() +
  labs(title = "Average Screen On Time by Age",
       x = "Age",
       y = "Average Screen On Time (hours/day)") +
  theme_minimal()

screen_time_individual <- data %>%
  group_by(Age, Gender) %>%
  summarise(Average_Screen_On_Time = mean(Screen.On.Time..hours.day., na.rm = TRUE), .groups = "drop")

# Plot the average screen time by age, with a smoothed curve
ggplot(screen_time_individual, aes(x = Age, y = Average_Screen_On_Time, color = Gender, group = Gender)) +
  geom_point() +  # Points for each age
  geom_smooth(method = "loess", span = 0.3, se = FALSE) +  # Smooth line with LOESS
  scale_color_manual(values = c("Male" = "blue", "Female" = "red")) +
  labs(title = "Average Screen On Time by Age and Gender (Smoothed)",
       x = "Age",
       y = "Average Screen On Time (hours/day)") +
  theme_minimal()
```








### Question 3: Does the amount of time spent on the phone daily correlate with the number of apps in that person's phone?


```{r}
correlation_data <- data %>%
  select(App.Usage.Time..min.day., Screen.On.Time..hours.day., Number.of.Apps.Installed, Age)

correlation_matrix <- cor(correlation_data, use = "complete.obs")

corrplot(correlation_matrix, method = "color", type = "upper", tl.srt = 45,
         title = "Correlation Matrix for Screen Time, App Usage, and Number of Apps Installed",
         addCoef.col = "red")

```
This correlation matrix reveals strong interconnections between app usage time, screen-on time, and the number of apps installed. Specifically, app usage time has a very high positive correlation with both screen-on time and the number of apps installed, indicating that users who install more apps tend to spend more time using them and consequently keep their screens on longer. However, age shows almost no correlation with these variables, I think this is due to the fact that the data set was not sampled randomly, but the average of all ages was asked.



